import{c as o,n as a,t as r,m as e,d as l,p as s,z as n,e as i,X as t,Y as d,w as c,B as u,D as v,S as g,N as f,g as h,ab as m,ah as p,ad as w,I as b,j as y}from "./index-ee55951f.js";const[z,S]=o("image");const L=y(l({name:z,props:{src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:a,height:a,radius:a,lazyLoad:Boolean,iconSize:a,showError:r,errorIcon:e("photo-fail"),iconPrefix:String,showLoading:r,loadingIcon:e("photo")},emits:["load","error"],setup(o, {emit:a,slots:r}){const e=s(!1),l=s(!0),y=s(),{$Lazyload:z}=n().proxy,L=i((()=>{const a={width:t(o.width),height:t(o.height)};return d(o.radius)&&(a.overflow="hidden",a.borderRadius=t(o.radius)),a}));c((()=>o.src),(()=>{e.value=!1,l.value=!0}));const x= o=>{l.value&&(l.value=!1,a("load",o))},I=()=>{const o=new Event("load");Object.defineProperty(o,"target",{value:y.value,enumerable:!0}),x(o)},j= o=>{e.value=!0,l.value=!1,a("error",o)},P=(a, r, e)=>e?e():h(b,{name:a,size:o.iconSize,class:r,classPrefix:o.iconPrefix},null),$=()=>{if(e.value||!o.src)return;const a={alt:o.alt,class:S("img"),style:{objectFit:o.fit,objectPosition:o.position}};return o.lazyLoad?m(h("img",w({ref:y},a),null),[[p("lazy"),o.src]]):h("img",w({ref:y,src:o.src,onLoad:x,onError:j},a),null)},B=({el:o})=>{const a=()=>{o===y.value&&l.value&&I()};y.value?a():f(a)},E=({el:o})=>{o!==y.value||e.value||j()};return z&&u&&(z.$on("loaded",B),z.$on("error",E),v((()=>{z.$off("loaded",B),z.$off("error",E)}))),g((()=>{f((()=>{var a;(null==(a=y.value)?void 0:a.complete)&&!o.lazyLoad&&I()}))})),()=>{var a;return h("div",{class:S({round:o.round,block:o.block}),style:L.value},[$(),l.value&&o.showLoading?h("div",{class:S("loading")},[P(o.loadingIcon,S("loading-icon"),r.loading)]):e.value&&o.showError?h("div",{class:S("error")},[P(o.errorIcon,S("error-icon"),r.error)]):void 0,null==(a=r.default)?void 0:a.call(r)])}}}));export{L as I};
