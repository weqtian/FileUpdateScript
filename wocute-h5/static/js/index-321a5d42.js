import{c as e,d as o,R as a,G as s,aP as t,p as n,e as i,w as l,L as c,g as r,n as m,aR as v,aS as u,r as d,b2 as p,O as g,b9 as A,ba as h,t as f,bb as y,a as I,a3 as C,m as b,T as w,S as k,P as x,Q as T,N as O,ad as Z,ae as N,ax as E,bc as R,I as U,a1 as M,B as L,J as P,ay as S,az as B,j as W,ag as z,ap as D,bd as H,o as X,al as Y,q as J,aA as F,u as V,ak as j,am as q,v as _,k as Q,aj as K,ai as $,a6 as G,a8 as ee,be as oe,bf as ae,_ as se}from "./index-ee55951f.js";import{d as te,M as ne,l as ie}from "./LangPlug-4fa84100.js";import{D as le,H as ce,O as re,a as me}from "./index-3ad53b22.js";import{a as ve,S as ue}from "./index-ff8e04d0.js";import{I as de}from "./index-456f307c.js";const pe= e=>Math.sqrt((e[0].clientX-e[1].clientX)**2+(e[0].clientY-e[1].clientY)**2),ge=e("image-preview")[1];var Ae=o({props:{src:String,show:Boolean,active:Number,minZoom:a(m),maxZoom:a(m),rootWidth:a(Number),rootHeight:a(Number),disableZoom:Boolean},emits:["scale","close","longPress"],setup(e, {emit:o,slots:a}){const m=s({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,initializing:!1,imageRatio:0}),f=t(),y=n(),I=n(),C=n(!1),b=n(!1);let w=0;const k=i((()=>{const{scale:e,moveX:o,moveY:a,moving:s,zooming:t,initializing:n}=m,i={transitionDuration:t||s||n?"0s":".3s"};return(1!==e||b.value)&&(i.transform=`matrix(${e}, 0, 0, ${e}, ${o}, ${a})`),i})),x=i((()=>{if(m.imageRatio){const{rootWidth:o,rootHeight:a}=e,s=C.value?a/m.imageRatio:o;return Math.max(0,(m.scale*s-o)/2)}return 0})),T=i((()=>{if(m.imageRatio){const{rootWidth:o,rootHeight:a}=e,s=C.value?a:o*m.imageRatio;return Math.max(0,(m.scale*s-a)/2)}return 0})),O=(a, s)=>{var t;if((a=u(a,+e.minZoom,+e.maxZoom+1))!==m.scale){const n=a/m.scale;if(m.scale=a,s){const e=g(null==(t=y.value)?void 0:t.$el),o={x:.5*e.width,y:.5*e.height},a=m.moveX-(s.x-e.left-o.x)*(n-1),i=m.moveY-(s.y-e.top-o.y)*(n-1);m.moveX=u(a,-x.value,x.value),m.moveY=u(i,-T.value,T.value)}else m.moveX=0,m.moveY=b.value?w:0;o("scale",{scale:a,index:e.active})}},Z=()=>{O(1)};let N,E,R,U,M,L,P,S,B=!1;const W= o=>{const{touches:a}=o;if(N=a.length,2===N&&e.disableZoom)return;const{offsetX:s}=f;f.start(o),E=m.moveX,R=m.moveY,S=Date.now(),B=!1,m.moving=1===N&&(1!==m.scale||b.value),m.zooming=2===N&&!s.value,m.zooming&&(U=m.scale,M=pe(a))},z=()=>{if(N>1)return;const{offsetX:e,offsetY:a}=f,s=Date.now()-S;e.value<A&&a.value<A&&(s<250?P?(clearTimeout(P),P=null,(()=>{const e=m.scale>1?1:2;O(e,2===e||b.value?{x:f.startX.value,y:f.startY.value}:void 0)})()):P=setTimeout((()=>{o("close"),P=null}),250):s>h&&o("longPress"))},D= o=>{let a=!1;if((m.moving||m.zooming)&&(a=!0,m.moving&&E===m.moveX&&R===m.moveY&&(a=!1),!o.touches.length)){m.zooming&&(m.moveX=u(m.moveX,-x.value,x.value),m.moveY=u(m.moveY,-T.value,T.value),m.zooming=!1),m.moving=!1,E=0,R=0,U=1,m.scale<1&&Z();const o=+e.maxZoom;m.scale>o&&O(o,L)}v(o,a),z(),f.reset()},H=()=>{const{rootWidth:o,rootHeight:a}=e,s=a/o,{imageRatio:t}=m;C.value=m.imageRatio>s&&t<2.6,b.value=m.imageRatio>s&&t>=2.6,b.value&&(w=(t*o-a)/2,m.moveY=w,m.initializing=!0,d((()=>{m.initializing=!1}))),Z()},X= e=>{const{naturalWidth:o,naturalHeight:a}=e.target;m.imageRatio=a/o,H()};return l((()=>e.active),Z),l((()=>e.show),(e=>{e||Z()})),l((()=>[e.rootWidth,e.rootHeight]),H),c("touchmove",(e=>{const{touches:o}=e;if(f.move(e),m.moving){const{deltaX:o,deltaY:a}=f,s=o.value+E,t=a.value+R;if((s>x.value||s<-x.value)&&!B&&f.isHorizontal())return void(m.moving=!1);B=!0,v(e,!0),m.moveX=u(s,-x.value,x.value),m.moveY=u(t,-T.value,T.value)}if(m.zooming&&(v(e,!0),2===o.length)){const e=pe(o),a=U*e/M;L=(e=>({x:(e[0].clientX+e[1].clientX)/2,y:(e[0].clientY+e[1].clientY)/2}))(o),O(a,L)}}),{target:i((()=>{var e;return null==(e=I.value)?void 0:e.$el}))}),()=>{const o={loading:()=>r(p,{type:"spinner"},null)};return r(ve,{ref:I,class:ge("swipe-item"),onTouchstartPassive:W,onTouchend:D,onTouchcancel:D},{default:()=>[a.image?r("div",{class:ge("image-wrap")},[a.image({src:e.src})]):r(de,{ref:y,src:e.src,fit:"contain",class:ge("image",{vertical:C.value}),style:k.value,onLoad:X},o)]})}}});const[he,fe]=e("image-preview"),ye=["show","teleport","transition","overlayStyle","closeOnPopstate"];var Ie=o({name:he,props:{show:Boolean,loop:f,images:y(),minZoom:I(1/3),maxZoom:I(3),overlay:f,closeable:Boolean,showIndex:f,className:C,closeIcon:b("clear"),transition:String,beforeClose:Function,overlayClass:C,overlayStyle:Object,swipeDuration:I(300),startPosition:I(0),showIndicators:Boolean,closeOnPopstate:f,closeIconPosition:b("top-right"),teleport:[String,Object]},emits:["scale","close","closed","change","longPress","update:show"],setup(e, {emit:o,slots:a}){const t=n(),i=s({active:0,rootWidth:0,rootHeight:0,disableZoom:!1}),c=()=>{if(t.value){const e=g(t.value.$el);i.rootWidth=e.width,i.rootHeight=e.height,t.value.resize()}},m= e=>o("scale",e),v= e=>o("update:show",e),u=()=>{M(e.beforeClose,{args:[i.active],done:()=>v(!1)})},d= e=>{e!==i.active&&(i.active=e,o("change",e))},p=()=>{if(e.showIndex)return r("div",{class:fe("index")},[a.index?a.index({index:i.active}):`${i.active+1} / ${e.images.length}`])},A=()=>{if(a.cover)return r("div",{class:fe("cover")},[a.cover()])},h=()=>{i.disableZoom=!0},f=()=>{i.disableZoom=!1},y=()=>{if(e.closeable)return r(U,{role:"button",name:e.closeIcon,class:[fe("close-icon",e.closeIconPosition),R],onClick:u},null)},I=()=>o("closed"),C=(e, o)=>{var a;return null==(a=t.value)?void 0:a.swipeTo(e,o)};return w({swipeTo:C}),k(c),l([x,T],c),l((()=>e.startPosition),(e=>d(+e))),l((()=>e.show),(a=>{const{images:s,startPosition:t}=e;a?(d(+t),O((()=>{c(),C(+t,{immediate:!0})}))):o("close",{index:i.active,url:s[i.active]})})),()=>r(E,Z({class:[fe(),e.className],overlayClass:[fe("overlay"),e.overlayClass],onClosed:I,"onUpdate:show":v},N(e,ye)),{default:()=>[y(),r(ue,{ref:t,lazyRender:!0,loop:e.loop,class:fe("swipe"),duration:e.swipeDuration,initialSwipe:e.startPosition,showIndicators:e.showIndicators,indicatorColor:"white",onChange:d,onDragEnd:f,onDragStart:h},{default:()=>[e.images.map(((s, t)=>r(Ae,{src:s,show:e.show,active:i.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:i.rootWidth,rootHeight:i.rootHeight,disableZoom:i.disableZoom,onScale:m,onClose:u,onLongPress:()=>o("longPress",{index:t})},{image:a.image})))]}),p(),A()]})}});let Ce;const be={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeIconPosition:"top-right"};const we=(e, o=0)=>{if(L)return Ce||({instance:Ce}=S({setup(){const{state:e,toggle:o}=B(),a=()=>{e.images=[]};return()=>r(Ie,Z(e,{onClosed:a,"onUpdate:show":o}),null)}})),e=Array.isArray(e)?{images:e,startPosition:o}:e,Ce.open(P({},be,e)),Ce};W(Ie);const ke="/static/png/default-wocute-avatar-official-b0adcba4.png",xe={zh:{voteNumberTips:"投票看其他 {0} 人的观点",more:"更多...",addAComment:"添加评论...",openWocute:"打开 Wocute"},en:{voteNumberTips:"Vote to see other {0} people's opinion",more:"More...",addAComment:"Add a comment...",openWocute:"Open Wocute"},fr:{voteNumberTips:"Votez pour voir l'opinion des autres {0} personnes",more:"Suite...",addAComment:"Ajouter un commentaire...",openWocute:"افتح Wocute"},ar:{voteNumberTips:"صوت لترى {0} آراء الآخرين",more:"المزيد...",addAComment:"اضفي تعليق...",openWocute:"Ouvrir Wocute"}},Te= e=>(oe("data-v-d31d076f"),e=e(),ae(),e),Oe={class:"header"},Ze={class:"portrait-name"},Ne={class:"name-time"},Ee={class:"name-box"},Re={class:"name"},Ue={class:"time"},Me={class:"follow-box"},Le=[Te((()=>j("div",{class:"item"},null,-1))),Te((()=>j("div",{class:"item"},null,-1))),Te((()=>j("div",{class:"item"},null,-1)))],Pe={class:"text"},Se={key:0,class:"img-box"},Be=["src","onClick"],We={key:1,class:"vote"},ze={class:"tips-text"},De={class:"card-box"},He={class:"text"},Xe={class:"operation"},Ye={class:"number"},Je={class:"number"},Fe={class:"name-content"},Ve={class:"name"},je={class:"content"},qe={key:0,class:"number"},_e={class:"placeholder"},Qe=se(o({__name:"index",setup(e){const o=ie(xe),a=z(),t=n(),l=n(!1),c=n(22),m=D(),{id:v}=m.query,u=n(),d={createdDate:"",momentType:"",comment:0,like:0,voteNumber:0,imageList:[],options:[],text:[],topicInfo:[],userInfo:{displayName:"",headImgUrl:"",id:"",identity:"",login:"",nickname:""}},p=n(d),g=n([]),A=n([]),h=s({DEFAULT_AVATAR:i((()=>(e, o)=>e?"OFFICIAL"===o?ke:e:le)),DEFAULT_AVATAR_OFFICIAL:i((()=>ke)),VIP_BADGE:i((()=>"/static/png/vip-badge-06bc35b1.png")),WELL_NUMBER:i((()=>"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAM1BMVEUAAAAAz58C0ZwC0ZwCz5sAz58D0pwC0ZwD0psC0ZsC0ZwC0Z0C0JoD0ZsC0ZwC0ZwD0Zzckh4kAAAAEHRSTlMAIN/vQBC/YKBwUM8wsJCA2IDWSgAAAWZJREFUWMPt1t2OgyAQBeAB5E9R5/2fdteygvFQHNM02TT9rhoyrZxhQqWvrw9n/XBaSeNAcisz65Eq67YVRUKeNybVlcAbbUlm4oe5LCjOIvVAuS4rI2eBeqB8OiTIFhJZ+Bxh4syTBJZb/tM/BihP50z6qnnZXm7ULhwz2Ti7qAhFwx0lk9KPvaTG8PXUTJrbM2X5mqntwJka+NpcN4ozlbinPjTys5kyfGk47nSk2xnMcaonAipM+lfZic7qisvdXh6fLT0TS/nOcbbuT/K+dznN0CRTWtCD5dAc6sHjtJhJxMNlApmyt7VAlznBTBIKyiHTm1sQOAuY6d59OkIm1U3uDAs51fq+ZjmT2sHlXDu4nCGgX/2Ble8IBKxmOd08hmCk+3fq1r/qALmbsBzfFETWp/dpJBEs51fuU3kL4HnQFEcy7lxuIVPfCK9iC9wFgmNYqbJh64AnMTWe//ZS9Ja+/rcfehZHOrZV4w4AAAAASUVORK5CYII=")),SHARE:i((()=>"/static/png/share-3de72a9e.png")),COMMENT:i((()=>"/static/png/comment-926e10ce.png")),HOLLOW:i((()=>ce)),PEN:i((()=>"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAAM1BMVEUAAADf39/f39/d3d3d3d3f39/f39/f39/d3d3d3d3e3t7d3d3d3d3b29ve3t7c3Nzd3d1V2Z+LAAAAEHRSTlMAQDDv3yB/EJBgv7Bw0M9QawnNOQAAAM1JREFUWMPt1lsOwiAQheFCQS69sf/VWo3xJBLbMGderPwL+DJM5oGh1+spFmzavAJzG8ueS6RjXXkVOWcs7yLpICOHHJS9TE6EgpZkZcatkoxwlkoKwjd9Sk7oVFKSOZXkZE4lOU84kEgH0sI5kJj9QCIdNCs5znenO3/teM5BTslJnINWJSdwDjKcg2bOQRPnoFXJCZyDjIJT7zqHAYl3PU5mIMpPI8fkBy4zPYyLZk1TX52lNHRwaltpLR5d9nnn/67Y6OTLHkvv17sDDpE3SgJ2sQMAAAAASUVORK5CYII="))}),f={openApp(){l.value=!0},getHollowWidth(){O((()=>{var e;let o=22;const a=null==(e=t.value)?void 0:e.children;if(a){for(let e=0; e<a.length; e++){const s=a[e].lastChild.offsetWidth;s>o&&(o=s)}c.value=F(o)}}))},imagePreview(e=0){we(g.value,e)},getMomentData(){const e={displayName:"",headImgUrl:le,id:"",identity:"NORMAL_USER",login:"",nickname:""};var o;(o={momentId:v},te.get({url:"/services/community/api/moment/detail",params:o})).then((o=>{var a,s;const t=o.data||d;let n=[],i=0;t.userInfo||(t.userInfo=e),t.realityUserInfo&&(t.userInfo.displayName=t.realityUserInfo.nickname||"",t.userInfo.headImgUrl=t.realityUserInfo.headImgFileUrl||"",t.userInfo.userId=t.realityUserInfo.login||""),o.data&&(p.value=t),(null==(a=t.imageList)?void 0:a.length)&&t.imageList.forEach((e=>{n.push(e.url)})),(null==(s=t.options)?void 0:s.length)&&t.options.forEach((e=>{i+=e.votes})),t.voteNumber=i,g.value=n})),(e=>te.get({url:"/services/community/api/comment/list",params:e}))({momentId:v,pageNo:1,pageSize:3}).then((e=>{const{list:o=[]}=e.data||{};A.value=o,f.getHollowWidth()}))},openAppLink(){const e=encodeURIComponent(`Moment/Details?id=${v}`);u.value=`?url=${e}&urlType=SHORT`}};return k((()=>{a.setLanguage(H()),f.getMomentData(),f.openAppLink()})),(e, s)=>{const n=de;return X(),Y(ne,null,{default:J((()=>[r(V(re),{query:u.value},null,8,["query"]),j("div",{class:G(["posts-container",{"posts-container-ar":V(a).getIsRtl}])},[j("div",Oe,[j("div",Ze,[r(n,{class:"portrait",round:"",src:h.DEFAULT_AVATAR(p.value.userInfo.headImgUrl,p.value.userInfo.identity),onClick:f.openApp},null,8,["src","onClick"]),j("div",Ne,[j("div",Ee,[j("div",Re,q(p.value.userInfo.displayName),1),"OFFICIAL"===p.value.userInfo.identity?(X(),Y(n,{key:0,class:"icon",round:"",src:h.VIP_BADGE},null,8,["src"])):_("v-if",!0)]),j("div",Ue,q(p.value.createdDate),1)])]),j("div",Me,[_(' <div class="btn" @click="methods.openApp">Follow</div>'),j("div",{class:"three-spot",onClick:s[0]||(s[0]=(...e)=>f.openApp&&f.openApp(...e))},Le)])]),(X(!0),Q($,null,K(p.value.topicInfo,((e, o)=>(X(),Q("div",{key:o,class:"topic",onClick:s[1]||(s[1]=(...e)=>f.openApp&&f.openApp(...e))},[r(n,{class:"icon",round:"",src:h.WELL_NUMBER},null,8,["src"]),j("div",Pe,q(e.name),1)])))),128)),j("article",null,[(X(!0),Q($,null,K(p.value.text,((e, o)=>(X(),Q("p",{key:o,class:"content"},q(e.text),1)))),128)),j("section",{class:"more",onClick:s[2]||(s[2]=(...e)=>f.openApp&&f.openApp(...e))},q(V(o)("more")),1),"PIC"===p.value.momentType?(X(),Q("div",Se,[(X(!0),Q($,null,K(p.value.imageList,((e, o)=>(X(),Q("img",{key:o,class:"item",src:e.url,alt:"WOCUTE",onClick: e=>f.imagePreview(o)},null,8,Be)))),128))])):_("v-if",!0),"VOTE"===p.value.momentType?(X(),Q("div",We,[j("div",ze,q(V(o)("voteNumberTips",`${p.value.voteNumber}`)),1),j("div",De,[(X(!0),Q($,null,K(p.value.options,((e, o)=>(X(),Q("div",{key:o,class:"item"},[j("span",He,q(e.option),1),j("div",{class:"circle",onClick:s[3]||(s[3]=(...e)=>f.openApp&&f.openApp(...e))})])))),128))])])):_("v-if",!0),j("div",Xe,[_(' <div class="item" @click="methods.openApp">'),_('    <van-image class="icon" round :src="RESOURCES.SHARE" />'),_('    <span class="number">666</span>'),_(" </div>"),j("div",{class:"item",onClick:s[4]||(s[4]=(...e)=>f.openApp&&f.openApp(...e))},[r(n,{class:"icon",round:"",src:h.COMMENT},null,8,["src"]),j("span",Ye,q(p.value.comment),1)]),j("div",{class:"item",onClick:s[5]||(s[5]=(...e)=>f.openApp&&f.openApp(...e))},[r(n,{class:"icon",round:"",src:h.HOLLOW},null,8,["src"]),j("span",Je,q(p.value.like),1)])])]),A.value.length?(X(),Q("div",{key:0,ref_key:"commentRef",ref:t,class:"comment-box"},[(X(!0),Q($,null,K(A.value,((e, o)=>(X(),Q("div",{key:o,class:"item"},[j("div",Fe,[j("span",Ve,q(e.commentUserInfo&&e.commentUserInfo.displayName||e.commentRealityUserInfo&&e.commentRealityUserInfo.nickname)+":",1),j("span",je,q(e.text),1)]),j("div",{style:ee({width:c.value}),class:"hollow"},[r(n,{class:"icon",round:"",src:h.HOLLOW,onClick:f.openApp},null,8,["src","onClick"]),e.like?(X(),Q("div",qe,q(e.like),1)):_("v-if",!0)],4)])))),128))],512)):_("v-if",!0),j("div",{class:"input-box",onClick:s[6]||(s[6]=(...e)=>f.openApp&&f.openApp(...e))},[r(n,{class:"icon",round:"",src:h.PEN},null,8,["src"]),j("span",_e,q(V(o)("addAComment")),1)]),r(V(me),{show:l.value,query:u.value,onOnConfirm:f.openApp,onOnClose:s[7]||(s[7]= e=>l.value=!1)},null,8,["show","query","onOnConfirm"])],2),_('        <div class="open-app-box">'),_('            <div class="btn" @click="methods.openApp">Open Wocute</div>'),_("        </div>")])),_:1})}}}),[["__scopeId","data-v-d31d076f"],["__file","/Users/xiaobo/Desktop/wocute/h5-client-cache/source/src/pages/share/posts/index.vue"]]);export{Qe as default};
